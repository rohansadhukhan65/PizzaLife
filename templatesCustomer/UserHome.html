<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <!-- Fontawsome css -->
 <!--  <link rel="stylesheet" href="/static/fontawsome/css/all.css"> -->
  <!--load all styles -->
   <link rel="stylesheet" href="/static/fontawsome/css/brands.css">
  <link rel="stylesheet" href="/static/fontawsome/css/fontawsome.css">
  <link rel="stylesheet" href="/static/fontawsome/css/regular.css">
  <link rel="stylesheet" href="/static/fontawsome/css/solid.css">
  <link rel="stylesheet" href="/static/fontawsome/css/svg-with-js.css">
  <link rel="stylesheet" href="/static/fontawsome/css/v4-shims.css">  

  <!-- javascript fontawsome -->
 <!--  <script defer src="all.js"></script> -->
  <!--load all styles -->
  <script defer src="/static/fontawsome/js/fontawesome.js"></script>
  <script defer src="/static/fontawsome/js/brands.js"></script>
  <script defer src="/static/fontawsome/js/solid.js"></script>
  <script defer src="/static/fontawsome/js/conflict-detection.js"></script>
  <script defer src="/static/fontawsome/js/regular.js"></script>
  <script defer src="/static/fontawsome/js/v4-shims.js"></script>  


  <title> Pizza Life </title>
  <!-- add icon link -->
  <link rel="icon" href="/static/images/Logo.png" type="image/x-icon">


  <style>
    div.sticky {
      position: -webkit-sticky;
      position: sticky;
      top: 200px;
      padding: 50px;
      font-size: 20px;
    }


.shadowmy:hover{
  box-shadow: 0 10px 20px 0 rgba(0, 0, 0, 0.2), 0 10px 20px 0 rgba(0, 0, 0, 0.19);
}
    
  </style>
</head>

<body>









  <nav class="navbar navbar-expand-lg navbar-warning bg-warning shadow sticky-top">

    <div>

      <a class="navbar-brand  text-dark text-center  text-center" href="/" style="font-size: 30px; float: left;"><img
          src="/static/images/Logo.png" width="60" height="60" alt="" loading="fast">PizzaLife</a>

    </div>


    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="text-dark"><svg width="2em" height="2em" viewbox="0 0 16 16" class="bi bi-text-right"
          fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd"
            d="M6 12.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-4-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5zm4-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-4-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z" />
        </svg></span>
    </button>





    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav  text-dark   ml-auto mr-auto">
        <li class="nav-item text-center pr-lg-5 mr-lg-5 pl-lg-5 ml-lg-5">
          <div class="mr-lg-5 pr-lg-5 ml-lg-5 pl-lg-5 text-center">
            <h5 class="pr-lg-5 mr-lg-5 pl-lg-5   font-weiight-light text-center text-success">Welcome, {{name.username}} <i
                class="far fa-user"></i></h5>
          </div>
        </li>
        <li class="nav-item text-center  ">
          <a class="nav-link text-dark  " href="/Logout/"><button class="btn btn-dark"> Log Out</button></a>
        </li>
        <li class="nav-item text-center">
            <a class="nav-link text-dark"  ><button type="button" id="popcart" class="btn btn-dark" data-container="body" data-toggle="popover" data-placement="bottom" data-html="true" data-content="Product Card"> Cart (<span id="cart">0</span>)</button></a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- End of Nav -->






  <!-- Start Of Body-->


  
  <div class="container py-5 my-5">
    <div class="row">
      <div class="col-12 col-lg-12">
          
        

      <!-- Start pizza  Menu----------------------------------------------------->
       <h3 class=" font-weight-light pb-3 mt-5">Pizza Menu <i class="fas fa-pizza-slice"></i></h3>
        <hr>
        <div class="row">
         
              {% for i in product %} 
              {% if i.category == "Pizza Menu"%}
               <div class="col-3"> 
                <div class="card mt-3 shadowmy" style="width: 14rem;"  >
                
                    <img class="card-img-top p-1" src="{{i.image.url}}" height="200px" alt="Card image cap">
                  <div class="card-body pt-0 mt-0">
                    <h5 class="card-title  " id="namepr{{i.id}}"> {{i.product_name}}  </h5>
                    $ <span class="font-weight-bold" id="price{{i.id}}"> {{i.price}}</span>
                    <p class="card-text text-justify font-weight-light"> <small class="text-justify font-weight-light">{{i.desc}}</small></p>
                    <span id="divpr{{i.id}}" class="divpr"> <button id="pr{{i.id}}" class="btn btn-dark  " onclick="addcart('{{i.id}}','{{name.id}}')">Add Cart</button> </span>
                  </div>
                </div>
               </div>
              {% endif %}
              {% endfor %} 
         
        </div>
        
        <!-- end Start pizza  Menu----------------------------------------------------->





        <!-- Start Sides Menu----------------------------------------------------->
       <h3 class=" font-weight-light pb-3 pt-5 mt-5">Sides Menu <i class="fas fa-hamburger"></i></h3>
        <hr>
         <div class="row">
        {% for i in product %} 
        {% if i.category == "Sides Menu"%}
                <div class="col-3"> 
                  <div class="card mt-3 shadowmy" style="width: 14rem;"  >
                
                    <img class="card-img-top p-1" src="{{i.image.url}}" height="200px" alt="Card image cap">
                    <div class="card-body pt-0 mt-0">
                      <h5 class="card-title  " id="namepr{{i.id}}"> {{i.product_name}}  </h5>
                      $ <span class="font-weight-bold" id="price{{i.id}}"> {{i.price}}</span>
                      <p class="card-text text-justify font-weight-light"> <small class="text-justify font-weight-light">{{i.desc}}</small></p>
                      <span id="divpr{{i.id}}" class="divpr"> <button id="pr{{i.id}}" class="btn btn-dark cart">Add Cart</button> </span>
                    </div>
                </div>
               </div>
        {% endif %}
        {% endfor %} 

        </div>
        <!-- end Sides Menu----------------------------------------------------->





        <!-- Start Drink Menu----------------------------------------------------->
       <h3 class=" font-weight-light pb-3 pt-5 mt-5">Drink Menu <i class="fas fa-glass-martini-alt"></i></h3>
        <hr>
        <div class="row">

            {% for i in product %} 
            {% if i.category == "Drink Menu"%}
            <div class="col-3"> 
                  <div class="card mt-3 shadowmy" style="width: 14rem;"  >
                
                    <img class="card-img-top p-1" src="{{i.image.url}}" height="200px" alt="Card image cap">
                    <div class="card-body pt-0 mt-0">
                      <h5 class="card-title  " id="namepr{{i.id}}"> {{i.product_name}}  </h5>
                      $ <span class="font-weight-bold" id="price{{i.id}}"> {{i.price}}</span>
                      <p class="card-text text-justify font-weight-light"> <small class="text-justify font-weight-light">{{i.desc}}</small></p>
                      <span id="divpr{{i.id}}" class="divpr"> <button id="pr{{i.id}}" class="btn btn-dark cart">Add Cart</button> </span>
                    </div>
                </div>
               </div>
            {% endif %}
            {% endfor %} 
        </div>
        
        <!-- end Drink Menu----------------------------------------------------->




        <!-- Start Desert Menu----------------------------------------------------->
       <h3 class=" font-weight-light pb-3 pt-5 mt-5">Desert Menu <i class="fas fa-cookie"></i></h3>
        <hr>
        <div class="row">
            {% for i in product %} 
            {% if i.category == "Desert Menu"%}
            <div class="col-3"> 
                  <div class="card mt-3 shadowmy" style="width: 14rem;"  >
                
                    <img class="card-img-top p-1" src="{{i.image.url}}" height="200px" alt="Card image cap">
                    <div class="card-body pt-0 mt-0">
                      <h5 class="card-title  " id="namepr{{i.id}}"> {{i.product_name}}  </h5>
                      $ <span class="font-weight-bold" id="price{{i.id}}"> {{i.price}}</span>
                      <p class="card-text text-justify font-weight-light"> <small class="text-justify font-weight-light">{{i.desc}}</small></p>
                      <span id="divpr{{i.id}}" class="divpr"> <button id="pr{{i.id}}" class="btn btn-dark cart">Add Cart</button> </span>
                    </div>
                </div>
               </div>
            {% endif %}
            {% endfor %} 
        </div>
        
        <!-- end Desert Menu----------------------------------------------------->


    </div>
  </div>
</div>

      <!-- End Body -->
      {% comment %} Footer {% endcomment %}
      <footer>
        <div class="container-fluid bg-warning  text-center">


          <!-- 1st row -->
          <div class="row pt-5 mt-5">
            <!-- col 1 -->
            <div class="col-12 col-md-4 py-3 pb-3 ">
              <h5 class="text-dark  mt-3 ">Quick Links</h5>
              <a class="text-dark d-block" href="/" style="text-decoration: none;">Home</a>
              <a class="text-dark d-block" href="/" style="text-decoration: none;">About Us</a>
              <a class="text-dark d-block" href="/" style="text-decoration: none;">Contact Us</a>
            </div>
            <!-- col 2 -->
            <div class="col-12 col-md-4 py-3 text-light text-center">
              <h5 class="text-dark  ">Our Polices</h5>
              <a class="text-dark d-block" href="#" style="text-decoration: none;">Terms & Conditions</a>
            </div>
            <!-- col 3 -->
            <div class="col-12 col-md-4 py-3">
              <h5 class="text-dark mb-3">Social</h5>
              <center class="py-1"><a href="#">
                  <i class="fab fa-facebook text-dark" style="height: 6%; width: 6%;"></i>
                </a></center>
              <center class="py-1"><a href="#">
                  <i class="fab fa-instagram text-dark" style="height: 6%; width: 6%;"></i>
                </a></center>

            </div>
          </div>




          <div class="row justify-content-center py-3">
            <div class="col-12 py-3 text-light text-justify ">
              <p class="text-dark text-center"> Copyright &#169; PizzaLife 2021</p>
            </div>
          </div>





        </div>
      </footer>





      <!-- Optional JavaScript; choose one of the two! -->

      <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
      
     <!--  Option 2: jQuery, Popper.js, and Bootstrap JS -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js"
        integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s"
        crossorigin="anonymous"></script>
      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>



        <!-- =============== ajac cdn =============== -->
        <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>



    <script>
// Find out the cart items from localStorage
if (localStorage.getItem('cart') == null) {
    var cart = {};
} else {
    cart = JSON.parse(localStorage.getItem('cart'));
    updateCart(cart);
}
// If the add to cart button is clicked, add/increment the item
// $('.cart').click(function() {
  $('.divpr').on('click', 'button.cart', function(){
    var idstr = this.id.toString();
    if (cart[idstr] != undefined) {
      qty +  cart[idstr][0] + 1;
      name = "my item"
      cart[idstr] = [qty , name];
    }
     else {
      qty = 1;
      name = document.getElementById('name'+idstr).innerHTML;
        cart[idstr] =[qty , name];
        console.log('cart[idstr]')
        console.log(cart[idstr][1])
    }
    updateCart(cart);
    
});
//Add Popover to cart
$('#popcart').popover();

 updatePopover(cart);


function updatePopover(cart){
  
    var popStr = "";
    popStr = popStr + "<h5 class='text-center'>  Your Order's </h5><div class='mx-2 my-2 font-weight-light'>";
    var i = 1;
    for (var item in cart){
        popStr = popStr + "<b>" + i + "</b>. ";
        console.log('name'+item);
        popStr = popStr + document.getElementById('name'+item).innerHTML.slice(0, 19) + "... Qty: " + cart[item][0] + '<br>';
        i = i+1;
    }
    popStr = popStr + "</div> <a href='/Checkout'><button class='btn btn-dark' id='checkOut'>Checkout</button></a>  <button class='btn btn-dark' onclick='clearcart()' id='clearcart'>Clear Cart</button> ";
    console.log(popStr); 
    console.log("this is popstrt"); 
    document.getElementById("popcart").setAttribute('data-content', popStr);
    $("#popcart").popover('show');
    $("#popcart").popover('hide');
    
}


function clearcart(){
  cart = JSON.parse(localStorage.getItem('cart'));
  for ( var item in cart){
    document.getElementById('div' + item).innerHTML = '<button id="'+ item +'" class="btn btn-dark cart">Add Cart</button>'
  }
  localStorage.clear();
  cart = {};
  updateCart(cart);
}

function updateCart(cart) {
  var sum = 0;
    for (var item in cart) {
      sum = sum+ cart[item][0];
        document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-dark minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-dark plus'> + </button>";
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    document.getElementById('cart').innerHTML = sum;
    console.log(cart);
    updatePopover(cart);
   
}
// If plus or minus button is clicked, change the cart as well as the display value
$('.divpr').on("click", "button.minus", function() {
    a = this.id.slice(7, );
    cart['pr' + a][0] = cart['pr' + a][0] - 1;
    cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateCart(cart);
});
$('.divpr').on("click", "button.plus", function() {
    a = this.id.slice(6, );
    cart['pr' + a][0] = cart['pr' + a][0] + 1;
    document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
    updateCart(cart);
});
</script>
 


<script>

  function addcart(prodid,customer){
      console.log('Product ID');
      console.log(prodid);
      console.log('customer');
      console.log(customer);



     $.ajax({
    type: 'POST',
    data: {'pid': prodid,'cid': customer,},
    url: '/cart/',
     success: function (response) {
      
      // console.log(response );
      var data = response.UndTer;
      var output = '';


    }
  });
  }
</script>
</body>

</html>